---
title: "Lily Lake Biogeochem"
author: "Matthew J Berens"
date: "1/18/2021"
output: html_notebook
---

```{r setup, include=FALSE}
#Load in the required packages
library(dplyr)
library(ggplot2)
library(tidyverse)
library(rbacon)
library(Bchron)
library(readr)
library(rioja)
library(rlist)
library(ggpmisc)

#Load the Lily Lake Core
setwd("~/Documents/Postdocs/LLO/ISRO_Paleo")
LS16BELL00 <- read_csv("Cores/LS16BELL00/LS16BELL00.csv")
LS16BELLRC <- read_csv("Cores/LS16BELLRC/LS16BELLRC.csv")
LilyLake <- list.load("LilyLake.Rdata")

```

## Oveview

This is an R Markdown document for the analysis of Lily Lake Biogeochem.

## Metals Analysis

### Lead and Potassium

```{r metals, echo=TRUE}
metals <- filter(LS16BELL00, IsMetals == "TRUE") %>%
  select(Entry:U) %>%
  pivot_longer(cols = Li:U,
               names_to = "Element",
               values_to = "Value")

metals <- filter(metals, Element == "Pb" | Element == "K")

plot <- metals %>%
  ggplot(aes(AgeMed, Value)) +
  geom_line() +
  coord_flip() +
  theme_bw() +
  scale_x_reverse(limits = c(10000,0)) +
  labs(y = "Concentration (ppm)", x = "Calendar Years BP") +
  facet_grid(~Element, scales = "free_x") +
  stat_peaks(strict = TRUE, geom = "text", ignore_threshold = 0.1)
  
plot
```

There are corresponding peaks in the Pb and K results at 5993 and 9312 yrs BP

```{r organic. echo=FALSE}

organic <- filter(LS16BELL00, IsOrganic == "TRUE") %>%
  select(Entry:d13C) %>%
  select(-(Li:U)) %>%
  pivot_longer(cols = S_V:d13C,
               names_to = "Element",
               values_to = "Value")

organic <- filter(organic, Element == "CN_mol" | Element == "CN_pct")
organic <- organic[!is.na(organic$Value),]

plot <- organic %>%
  ggplot(aes(AgeMed, Value)) +
  geom_line() +
  coord_flip() +
  #geom_point() +
  theme_bw() +
  scale_x_reverse(limits = c(10000,0)) +
  labs(y = "Concentration", x = "Age yrs BP") +
  facet_grid(~Element, scales = "free_x") 
  #stat_peaks(strict = TRUE, geom = "text", ignore_threshold = 0.1)
  
plot

```